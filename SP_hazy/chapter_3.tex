%   Filename    : chapter_3.tex 
\chapter{Research Methodology}
This chapter lists and discusses the specific steps and activities that will be performed  to accomplish the project. 
The discussion covers the activities from pre-proposal to Final SP Writing.

\section{Technologies Used}
The technologies that will be utilized for this project are the following in the following subsections

\subsection{Roboflow}
Roboflow offers a suite  of browser applications to preprocess and preparation of the data for computer vision and machine learning. Roboflow annotation will be used  to manually set bounding boxes for model training and image augmentation for the manipulation of images. \cite{roboflow}

\subsection{Jupyter Notebook using Google Colab and Python}
Jupyter Notebook and Python will be used for training and fitting the data. Jupyter notebook, using google colab,  offers free GPU with CUDA for processing, and Python, the programming language, offers essential libraries for machine learning. \cite{googlecolab}

\subsection{YOLOv5}
 YOLOV5 is an object detection algorithm which simplifies the workflow of training the dataset. It will serve as the object detection algorithm that will be used for training the dataset and counting vehicles in a video or live footage in this project.

\section{Research Activities}
To explore YOLOv5 two models will be used. One model is a pre-trained model that comes with YOLOv5 and a custom model trained with a dataset taken from Kaggle. YOLOv5 has options to download and use pre-trained models on the YOLOv5 GitHub page \cite{ultralytics}. This model will serve as a basis to benchmark the performance of the custom data.

\subsection {Data Gathering}
This study plans to identify an area’s pollution level through calculating average of the emissions coming from the cars on the road. In doing so, data of the vehicles, its identification, and its emission rates are needed for the study. Through the use of a camera, a live feed of the vehicles in traffic can be recorded to gather the data of cars in traffic. Image samples of the vehicles (Cars, Motorcycles, and Trucks) will be taken from the Kaggle dataset, Traffic Images Of Vehicles \cite{DVN/POREXF_2020}. This can be utilized in training and testing for the software to recognize the vehicles on the video feed. The vehicle emissions will be taken from an average CO2 emissions of vehicles (four-wheelers and motorcycles) from a dataset provided by Gov.Uk (2020). 

Due to the study being conducted in the country of the Philippines, vehicles such as the local jeepney and tricycle do not have readily available image datasets.Videos and Images of said vehicles in traffic were taken from different angles using a phone camera. 


\subsection {Preprocessing}

	Preprocessing the data includes defining the bounding box of the vehicles in the training data and augmenting the images to make the model perform better. Roboflow has an annotation tool that can be used for  training the model to detect a vehicle in an image and its type. Augmentation of the images will be done by the YOLOv5 algorithm automatically given that the Albumentation library is installed. Augmentation can be used for transforming the images allowing the model to diversify its training data set making it perform better.\cite{dilmegani} 
	
	Annotation of the vehicles consist of: full image annotation and vehicle cropping. In full image annotation, the entire image or video frame is used and every vehicle present is then selected and categorized for the Roboflow tool to save. Vehicle cropping is when a vehicle/small group of vehicles is/are cropped from the source image/video frame and is then annotated by the tool. This was done when a specific type of vehicle was needed for the database.
	


\subsection {Training and Performance Testing}

The training data will be separated into classes: cars, jeepneys, motorcycles, tricycles, trucks, and utility vehicles. These classes will be the bases of classification for the training.  For performance testing, there are visualization tools available to visualize the performance of the model. In this project, Tensorboard will be used since it is already available in python and can be rendered using Jupyter notebook. The training time will be based on the performance parameters (Precision and Recall being the most important). If little to no improvement is being done by subsequent iterations on the performance parameters the training will be interrupted. To benchmark the performance of the custom data it will be compared against the pre-trained weights available for YOLOv5. 

\section {Model Applictation}
The program detect.py will be run to detect objects from an external device or video file using the trained model. When detect.py is run it will start to list the objects it detects. An average emission of each vehicle type will be used. The study from \cite{rito_lopez_biona_2021} provides a table that quantifies the emission factors of energy consumption of multiple vehicle types, 6 of which are to be used in this study. The emission data from the study will be utilized for the application.The table below shows the grams of emissions per kilometer.
The averages of the vehicles’ $PM_{2.5}$ emissions  at a given time will be displayed in a real-time chart and will be periodically updated as vehicles enter and leave the camera’s or video’s line of sight. 

\begin{table}[ht]   %t means place on top, replace with b if you want to place at the bottom
\centering
\caption{Emission factors per vehicle type ($g_{emissions}/km$)} \vspace{0.25em}
\begin{tabular}{|p{2in}|c|c|c|c|} \hline
\centering Vehicle Type & $PM_{2.5}$ & \ch{CH4} & \ch{N2O} & \ch{CO2} \\ \hline
Tricycle   & 0.0562   & 4.0906 & 0.0021 &  66.8747\\ \hline
Motorcycle& 0.0336  &2.3022   & 0.0015 & 60.0983\\ \hline
Jeepney &0.8466&0.2357  &0.0316	& 668.7415\\ \hline
Car & 0.0221 & 0.7408  & 0.0099  & 109.8958\\ \hline
Utility & 0.1430 & 0.3538 & 0.0063 & 92.4039\\ \hline
Light Truck & 0.7519 & 0.3648 & 0.0226 & 842.0852\\ \hline

\end{tabular}
\label{tab:emission}
\end{table}




\section{Calendar of Activities}

Table \ref{tab:timetableactivities} shows a Gantt chart of the activities for the development of Hazy.  Each bullet represents approximately
one week worth of activity.

%
%  the following commands will be used for filling up the bullets in the Gantt chart
%
\newcommand{\weekone}{\textbullet}
\newcommand{\weektwo}{\textbullet \textbullet}
\newcommand{\weekthree}{\textbullet \textbullet \textbullet}
\newcommand{\weekfour}{\textbullet \textbullet \textbullet \textbullet}

%
%  alternative to bullet is a star 
%
\begin{comment}
   \newcommand{\weekone}{$\star$}
   \newcommand{\weektwo}{$\star \star$}
   \newcommand{\weekthree}{$\star \star \star$}
   \newcommand{\weekfour}{$\star \star \star \star$ }
\end{comment}



\begin{table}[ht]   %t means place on top, replace with b if you want to place at the bottom
\centering
\caption{Timetable of Activities} \vspace{0.25em}
\begin{tabular}{|p{2in}|c|c|c|c|c|c|c|c|c|c|} \hline
\centering Activities  & Sept  & Oct & Nov & Dec & Jan & Feb & Mar & April & May & June\\ \hline
Finding and Choosing Final Topic      & ~~~\weektwo &  &  &  &  &  & &&& \\ \hline
Review of Related Literature &   & \weekfour & \weekfour &  &  &  & & ~~~\weekone& \weekone~~~ & \\ \hline
Identifying Problem Statement     &  ~~~\weektwo &  \weekone~~~  &  & &  &  &  &&&\\ \hline
Formation of Possible Solution    &   & ~~~\weektwo  &  \weekone~~~ &  & & & &&&  \\ \hline
Constructing the Methodology     &   &  &   ~~~\weektwo & \weekthree ~~ & &  & &&& \\ \hline

Documentation & ~~~\weektwo  & \weekfour & \weekfour &\weekone ~~& & ~~~\weektwo &  & ~~~\weektwo & \weekone~~~ & ~~~\\ \hline
Model Training   &  &  &  & & & & \weekone~~~  & ~~~\weektwo & \weekone~~~  & \\ \hline
Data Gathering & & & & & &\weekfour&\weekfour& \weekfour & &~~~  \\ \hline
Testing     &   &  &  & \weekthree ~~ & &  & ~\weekone~ & ~~~\weekone & \weekone~~~ &  \\ \hline
Interpretation of Results     &   &  &  & \weekthree ~~ & &  & &~~~\weekone& \weekone~~~ & \\ \hline

\end{tabular}
\label{tab:timetableactivities}
\end{table}

